name: Build Godot Nightly
on: 
  workflow_dispatch: 
  schedule:
    - cron: '15 13 * * *'

concurrency:
  group: ci-${{github.actor}}-${{github.head_ref || github.run_number}}-${{github.ref}}-runner
  cancel-in-progress: true

jobs:
  clone-godot-repo:
    name: üì¶ Clone Godot
    runs-on: ubuntu-latest
    steps:
      - uses: sudosubin/git-clone-action@v1.0.1
        with:
          repository: 'godotengine/godot'
          platform: 'github'
          path: 'godot'
      - name: Zip
        run: |
          zip -r "godot.zip" "godot"
      - name: Upload a Dict Artifact
        uses: actions/upload-artifact@v4.3.1
        with: 
         name: "godot-source"
         path: "godot.zip"
         retention-days: 7

  linux-build:
    if: ${{ vars.DISABLE_GODOT_CI == '' }}
    needs: clone-godot-repo
    name: üêß Linux
    uses: ./.github/workflows/linux_builds.yml

#  macos-build:
#    if: ${{ vars.DISABLE_GODOT_CI == '' }}
#    name: üçé macOS
#    uses: ./.github/workflows/macos_builds.yml

  windows-build:
    if: ${{ vars.DISABLE_GODOT_CI == '' }}
    needs: clone-godot-repo
    name: üèÅ Windows
    uses: ./.github/workflows/windows_builds.yml


